version: '2'

services:
  hatu:
    build: .
    volumes:
      - ./client:/hatu/client
      - ./server:/hatu/server
      - ./config:/hatu/config
      - /hatu/node_modules
      - ./package.json:/hatu/package.json
      - ./.babelrc:/hatu/.babelrc
#  Since the editor may delete the original file and create a new one, the mount might be broken.
#  You may need to restart the service to synchronize the package.json and .babelrc

    depends_on:
      - dvid
      - pg
    ports:
      - 2222:2222

  dvid:
    image: "flyem/dvid"
    ports:
      - 8000:8000
    volumes_from:
      - slicedb
    depends_on:
      - slicedb

  slicedb:
    image: "hjwissac/slicedb"

  pg:
    build: pg/
    ports:
      - 3333:5432

networks:
  default: